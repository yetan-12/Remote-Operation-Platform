import{c as Ie,r as s,j as e,E as He,C as Ue,B as Xe}from"./index-DY71TD0q.js";import{C as qe,h as H,P as ye,r as We,a as Oe}from"./placeholders-CDPA95X-.js";import{C as pe,R as ne,L as le,a as oe,X as ce,Y as de,T as xe,b as me,c as E}from"./LineChart-YfjwtQUF.js";import{a as ve,H as je,M as Ne,C as Ze,R as Je}from"./rotate-ccw-ULH9JjFz.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],et=Ie("grip-vertical",Qe);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],st=Ie("pause",tt);function ot(){var K;const[U,ee]=s.useState("SE-20251217-003"),[R,k]=s.useState(!1),[L,T]=s.useState(""),[P,Y]=s.useState(null),[D,X]=s.useState(null),[g,F]=s.useState([]),[f,W]=s.useState(null),[V,A]=s.useState(!0),[he,te]=s.useState("2025-12-17"),[se,ae]=s.useState("2025-12-17"),[B,v]=s.useState(!1),[m,M]=s.useState(0),[l,G]=s.useState(150);s.useRef(null),s.useEffect(()=>{!f||!V||setTimeout(()=>{const a=document.querySelector(`[data-clip-id="${f}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)},[f,V]),s.useEffect(()=>{let a;return R&&(a=setInterval(()=>{M(h=>h>=l?(k(!1),0):h+1)},1e3)),()=>{a&&clearInterval(a)}},[R,l]);const d=a=>{const h=Math.floor(a/60),q=a%60;return`${h}:${q.toString().padStart(2,"0")}`},c=[{id:"C1225-01",duration:"00:42",description:"将夹住方形积木移至色盘上方"},{id:"C1225-02",duration:"00:35",description:"将夹住方形积木移至色盘上方"},{id:"C1225-03",duration:"00:51",description:"将夹住方形积木移至色盘上方"},{id:"C1225-04",duration:"00:38",description:"将夹住方形积木移至色盘上方"},{id:"C1225-05",duration:"00:45",description:"将夹住方形积木移至色盘上方"},{id:"C1225-06",duration:"00:39",description:"将夹住方形积木移至色盘上方"},{id:"C1225-07",duration:"00:44",description:"将夹住方形积木移至色��上方"},{id:"C1225-08",duration:"00:52",description:"将夹住方形积木移至���盘上方"},{id:"C1225-09",duration:"00:36",description:"将夹住方形积木至色盘上方"},{id:"C1225-10",duration:"00:48",description:"将夹住方形积木移至色盘"},{id:"C1224-01",duration:"00:41",description:"将夹住方形积木移至色盘上方"},{id:"C1224-02",duration:"00:47",description:"方形积木移至色盘上方"},{id:"C1224-03",duration:"00:43",description:"将夹住方形积木移至色盘上方"},{id:"C1224-04",duration:"00:50",description:"将夹住方形积木移至色盘上方"},{id:"C1224-05",duration:"00:37",description:"将夹住方形积木移至色盘上方"},{id:"C1223-01",duration:"00:46",description:"将夹住方形积木移至色盘上方"},{id:"C1223-02",duration:"00:40",description:"将夹住方形积木移至色盘上方"},{id:"C1223-03",duration:"00:49",description:"将夹住方形积木移至色盘方"}],_=[H,H,H,H,H,H],p=c.findIndex(a=>a.id===f),O=p===0,N=p===c.length-1,r=()=>{if(p>0){const a=c[p-1].id;W(a),setTimeout(()=>{const h=document.querySelector(`[data-clip-id="${a}"]`);h&&h.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)}},o=()=>{if(p<c.length-1){const a=c[p+1].id;W(a),setTimeout(()=>{const h=document.querySelector(`[data-clip-id="${a}"]`);h&&h.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)}},z=()=>{if(!P||!D){alert("请完成数据有效性和数据完成度的标注");return}console.log("提交标注",{selectedClip:f,dataValidity:P,dataCompleteness:D,selectedErrorTags:g,reviewComment:L}),W(null),Y(null),X(null),F([]),T(""),k(!1),M(0)},C=f==="C1225-01",w=f==="C1225-02";return e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:`bg-white border-r border-gray-200 flex flex-col relative transition-all duration-300 ${V?"w-[12.5%]":"w-12"}`,children:V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-3 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:"Clips列表"}),e.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",title:"折叠",children:e.jsx(qe,{size:18})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-1 space-y-1 custom-scrollbar",children:c.map((a,h)=>e.jsxs("div",{onClick:()=>W(a.id),className:`cursor-pointer transition-all rounded p-1 shadow-sm ${f===a.id?"ring-2 ring-blue-500 bg-blue-50":"hover:ring-1 hover:ring-gray-300 bg-white"}`,children:[e.jsxs("div",{className:"relative bg-black w-full aspect-video rounded overflow-hidden",children:[e.jsx("img",{src:_[h%_.length],alt:a.id,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-7 h-7 rounded-full bg-white/95 flex items-center justify-center shadow-lg",children:e.jsx(ye,{size:12,className:"text-gray-800 ml-0.5"})})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-black/80 text-white text-[9px] px-1.5 py-0.5 rounded font-medium",children:a.duration}),f===a.id&&e.jsx("div",{className:"absolute top-1 left-1 w-2 h-2 bg-blue-500 rounded-full ring-2 ring-white shadow-sm"})]}),e.jsx("div",{className:`px-1.5 py-1.5 transition-all ${f===a.id?"bg-blue-500 text-white":"bg-white text-gray-800"}`,children:e.jsx("div",{className:"text-[10px] font-bold text-center tracking-wide",children:a.id})})]},a.id))})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-full flex flex-col items-center py-4",children:[e.jsx("button",{onClick:()=>A(!0),className:"text-gray-400 hover:text-gray-600 transition-colors mb-4",title:"展开",children:e.jsx(pe,{size:18})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"[writing-mode:vertical-lr] text-sm font-semibold text-gray-600 tracking-wider",children:"Clips"})})]})})}),e.jsxs("div",{className:"flex-1 bg-gray-50 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"数据标注"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["已选择: ",f]}),e.jsxs("button",{className:"text-sm text-blue-600 hover:underline",children:["共 ",c.length," 条"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 custom-scrollbar",children:f?e.jsxs("div",{className:"bg-white rounded-lg p-6 mb-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"当前clips任务提示 (Prompt)"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["当前Prompt: ",((K=c.find(a=>a.id===f))==null?void 0:K.description)||"暂无描述"]})]}),C?e.jsx(Fe,{isPlaying:R,setIsPlaying:k,currentTime:m,duration:l,setCurrentTime:M,formatTime:d,dataValidity:P,setDataValidity:Y,dataCompleteness:D,setDataCompleteness:X,selectedErrorTags:g,setSelectedErrorTags:F,reviewComment:L,setReviewComment:T,isPoseDataExpanded:B,setIsPoseDataExpanded:v,isFirstClip:O,isLastClip:N,handlePreviousClip:r,handleNextClip:o,handleSubmitReview:z}):w?e.jsx(at,{isPlaying:R,setIsPlaying:k,currentTime:m,duration:l,setCurrentTime:M,formatTime:d,dataValidity:P,setDataValidity:Y,dataCompleteness:D,setDataCompleteness:X,selectedErrorTags:g,setSelectedErrorTags:F,reviewComment:L,setReviewComment:T,isPoseDataExpanded:B,setIsPoseDataExpanded:v,isFirstClip:O,isLastClip:N,handlePreviousClip:r,handleNextClip:o,handleSubmitReview:z}):e.jsx(Fe,{isPlaying:R,setIsPlaying:k,currentTime:m,duration:l,setCurrentTime:M,formatTime:d,dataValidity:P,setDataValidity:Y,dataCompleteness:D,setDataCompleteness:X,selectedErrorTags:g,setSelectedErrorTags:F,reviewComment:L,setReviewComment:T,isPoseDataExpanded:B,setIsPoseDataExpanded:v,isFirstClip:O,isLastClip:N,handlePreviousClip:r,handleNextClip:o,handleSubmitReview:z})]}):e.jsx("div",{className:"bg-white rounded-lg p-6 mb-4 h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(He,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"请选择 Clip 以开始数据标注"}),e.jsx("p",{className:"text-xs text-gray-500",children:"从左侧列表中选择一个 Clip 来查看详情并进行标注"})]})})})]})]})}function Ke({isPlaying:U,setIsPlaying:ee,currentTime:R,duration:k,setCurrentTime:L,formatTime:T,dataValidity:P,setDataValidity:Y,dataCompleteness:D,setDataCompleteness:X,selectedErrorTags:g,setSelectedErrorTags:F,reviewComment:f,setReviewComment:W,isFirstClip:V,isLastClip:A,handlePreviousClip:he,handleNextClip:te,handleSubmitReview:se}){const[ae,B]=s.useState(1),[v,m]=s.useState({x:0,y:0}),[M,l]=s.useState(!1),G=s.useRef(null),d=30,I=Math.floor(R*d),c=Math.floor(k*d),_=[.25,.5,1,2],p=()=>{L(0),ee(!0)},O=()=>{m({x:0,y:0})},N=r=>{var a;l(!0);const o=(a=G.current)==null?void 0:a.getBoundingClientRect();if(!o)return;const z=r.clientX-o.left,C=r.clientY-o.top,w=h=>{m({x:h.clientX-z,y:h.clientY-C})},K=()=>{l(!1),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",w),document.addEventListener("mouseup",K)};return e.jsxs("div",{className:"flex flex-col",style:{height:"calc(80vh - 160px)"},children:[e.jsxs("div",{ref:G,className:"fixed z-50 bg-white rounded-xl border border-gray-300 shadow-2xl p-4 flex items-center min-w-[700px] max-w-[900px]",style:{left:v.x===0&&v.y===0?"50%":`${v.x}px`,top:v.y===0?"auto":`${v.y}px`,bottom:v.y===0?"24px":"auto",transform:v.x===0&&v.y===0?"translateX(-50%)":"none",cursor:M?"grabbing":"default"},children:[e.jsx("div",{onMouseDown:N,className:"flex items-center justify-center px-2 cursor-grab active:cursor-grabbing hover:bg-gray-100 rounded-lg transition-colors mr-2",title:"拖动控制栏",children:e.jsx(et,{size:20,className:"text-gray-400"})}),e.jsx("button",{onClick:O,className:"p-2 hover:bg-gray-100 text-gray-600 hover:text-blue-600 rounded-lg transition-all mr-2",title:"重置位置",children:e.jsx(je,{size:18})}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>ee(!U),className:"p-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center flex-shrink-0 shadow-md hover:shadow-lg transition-all",title:U?"暂停":"播放",children:U?e.jsx(st,{size:18}):e.jsx(ye,{size:18})}),e.jsx("button",{onClick:p,className:"p-2.5 bg-gray-600 hover:bg-gray-700 text-white rounded-lg flex items-center justify-center flex-shrink-0 shadow-md hover:shadow-lg transition-all",title:"重播",children:e.jsx(Je,{size:18})}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 bg-gray-200 rounded-full h-1 cursor-pointer relative",style:{overflow:"visible"},onClick:r=>{if(r.target.closest("button"))return;const o=r.currentTarget.getBoundingClientRect(),C=(r.clientX-o.left)/o.width,w=Math.floor(C*k);L(w)},onMouseDown:r=>{if(r.target.closest("button"))return;const o=C=>{const w=r.currentTarget.getBoundingClientRect(),a=Math.max(0,Math.min(C.clientX-w.left,w.width))/w.width,h=Math.floor(a*k);L(h)},z=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",z)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",z)},children:[e.jsx("div",{className:"bg-blue-600 h-full transition-all duration-300 rounded-full",style:{width:`${R/k*100}%`}}),e.jsx("button",{onClick:r=>{r.stopPropagation(),r.preventDefault();const o=Math.floor(k*.5);L(o),console.log("跳转到关键帧:",o)},className:"absolute -top-4 left-1/2 -translate-x-1/2 hover:scale-110 transition-transform cursor-pointer z-10",style:{pointerEvents:"auto"},title:"关键帧",children:e.jsxs("div",{className:"flex flex-col items-center pointer-events-none",children:[e.jsx("div",{className:"w-0 h-0 border-l-[8px] border-r-[8px] border-t-[12px] border-l-transparent border-r-transparent border-t-orange-500 drop-shadow-lg"}),e.jsx("div",{className:"w-2 h-3 bg-gradient-to-b from-orange-500 to-orange-600 -mt-0.5 drop-shadow-lg rounded-b-sm"})]})})]}),e.jsxs("span",{className:"text-xs text-gray-600 font-medium whitespace-nowrap",children:[I," / ",c," 帧"]}),e.jsx("select",{value:ae,onChange:r=>B(Number(r.target.value)),className:"text-xs border border-gray-300 rounded-md px-2.5 py-1 bg-white hover:border-blue-400 focus:outline-none focus:border-blue-500 cursor-pointer font-medium text-gray-700",children:_.map(r=>e.jsxs("option",{value:r,children:[r,"x"]},r))})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-3",children:"标注操作"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-red-500 text-xs",children:"*"}),e.jsx("label",{className:"text-xs text-gray-700",children:"数据有效性:"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Y("valid"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${P==="valid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"有效"}),e.jsx("button",{onClick:()=>Y("invalid"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${P==="invalid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"无效"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-red-500 text-xs",children:"*"}),e.jsx("label",{className:"text-xs text-gray-700",children:"动作完成度:"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>X("complete"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${D==="complete"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"完成"}),e.jsx("button",{onClick:()=>X("incomplete"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${D==="incomplete"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"未完成"})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-2",children:"错误标签 (选填)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>{const r=document.getElementById("error-tags-dropdown");r&&r.classList.toggle("hidden")},className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-xs text-left hover:bg-gray-50 transition-colors flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-700",children:g&&g.length>0?`已选择 ${g.length} 个标签`:"选择错误标签"}),e.jsx(Ue,{className:"w-4 h-4 text-gray-500"})]}),e.jsx("div",{id:"error-tags-dropdown",className:"hidden absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg",children:["动作不完整","画面模糊","机械臂异常"].map(r=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-50 cursor-pointer text-xs",children:[e.jsx("input",{type:"checkbox",checked:g==null?void 0:g.includes(r),onChange:()=>{g!=null&&g.includes(r)?F(g.filter(o=>o!==r)):F([...g||[],r])},className:"w-4 h-4 text-blue-500 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:r})]},r))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col mb-3 min-h-0",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-2",children:"审核意见 (选填)"}),e.jsx("textarea",{placeholder:"请输入详细注意事项或说明信息",value:f,onChange:r=>W(r.target.value),className:"w-full flex-1 px-2.5 py-2 border border-gray-200 rounded-lg text-xs resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Xe,{className:`w-full h-8 text-xs ${A?"bg-gray-100 text-gray-400 border border-gray-200 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,onClick:()=>{if(!P||!D){alert("请完成数据有效性和动作完成度的标注");return}te()},disabled:A,children:"提交并下一条"}),e.jsx(Xe,{className:"w-full h-8 text-xs bg-white hover:bg-gray-50 text-gray-700 border border-gray-300",onClick:se,children:"提交并返回"})]})]})}function Fe(U){var Se,Me,ze,Le,Pe,De,Ae,Re,_e,$e,Ee,Ye;const{isPlaying:ee,setIsPlaying:R,currentTime:k,duration:L,setCurrentTime:T,formatTime:P,dataValidity:Y,setDataValidity:D,dataCompleteness:X,setDataCompleteness:g,selectedErrorTags:F,setSelectedErrorTags:f,reviewComment:W,setReviewComment:V,isPoseDataExpanded:A,setIsPoseDataExpanded:he,isFirstClip:te,isLastClip:se,handlePreviousClip:ae,handleNextClip:B,handleSubmitReview:v}=U;s.useRef(null);const[m,M]=s.useState(!1),[l,G]=s.useState(null),[d,I]=s.useState({arm:{x:0,y:0}}),[c,_]=s.useState({arm:{width:0,height:0}}),[p,O]=s.useState(null),[N,r]=s.useState({x:0,y:0}),[o,z]=s.useState(null),[C,w]=s.useState({x:0,y:0,width:0,height:0}),[K,a]=s.useState(!1),[h,q]=s.useState(!1),ge=(t,x)=>{x.stopPropagation(),I(y=>({...y,[t]:{x:0,y:0}})),_(y=>({...y,[t]:{width:0,height:0}}))},be=(t,x)=>{if(t.target.closest("button"))return;t.preventDefault(),t.stopPropagation(),a(!1),O(x);const y=t.currentTarget.getBoundingClientRect();r({x:t.clientX-y.left,y:t.clientY-y.top}),_(Q=>({...Q,[x]:{width:y.width,height:y.height}}))},i=(t,x)=>{var Q;t.preventDefault(),t.stopPropagation(),q(!1),z(x);const y=(Q=t.currentTarget.closest(".pip-container"))==null?void 0:Q.getBoundingClientRect();y&&w({x:t.clientX,y:t.clientY,width:y.width,height:y.height})};s.useEffect(()=>{const t=y=>{if(p&&(a(!0),I(Q=>({...Q,[p]:{x:y.clientX-N.x,y:y.clientY-N.y}}))),o){q(!0);const Q=y.clientX-C.x,Te=y.clientY-C.y,Ve=Math.max(150,C.width+Q),Be=Math.max(100,C.height+Te);_(Ge=>({...Ge,[o]:{width:Ve,height:Be}}))}},x=()=>{O(null),z(null)};if(p||o)return document.addEventListener("mousemove",t),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",x)}},[p,o,N,C]);const[b,u]=s.useState({action:!0,obs:!0}),[S,ue]=s.useState({action:!0,obs:!0}),[Z,fe]=s.useState({action:!0,obs:!0}),[J,we]=s.useState({action:!0,obs:!0}),[re,ke]=s.useState({action:!0,obs:!0}),[ie,Ce]=s.useState({action:!0,obs:!0}),[n,$]=s.useState(null),j=s.useMemo(()=>Array.from({length:50},(t,x)=>({frame:x,action_roll:-.5+Math.sin(x/8)*.3+(Math.random()-.5)*.1,obs_roll:-.5+Math.sin(x/8)*.3+(Math.random()-.5)*.15,action_angle:1.2+Math.cos(x/10)*.4+(Math.random()-.5)*.1,obs_angle:1.2+Math.cos(x/10)*.4+(Math.random()-.5)*.15,action_gripper:.8+Math.sin(x/6)*.2+(Math.random()-.5)*.08,obs_gripper:.8+Math.sin(x/6)*.2+(Math.random()-.5)*.12,action_pitch:.3+Math.cos(x/12)*.25+(Math.random()-.5)*.08,obs_pitch:.3+Math.cos(x/12)*.25+(Math.random()-.5)*.12,action_yaw:-.2+Math.sin(x/9)*.3+(Math.random()-.5)*.1,obs_yaw:-.2+Math.sin(x/9)*.3+(Math.random()-.5)*.15,action_velocity:.5+Math.cos(x/7)*.3+(Math.random()-.5)*.1,obs_velocity:.5+Math.cos(x/7)*.3+(Math.random()-.5)*.15})),[]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-5 mb-5",style:{gridTemplateColumns:"1fr 460px"},children:[e.jsx("div",{className:"relative",style:{height:"calc(80vh - 100px)"},children:e.jsxs("div",{className:"relative bg-black rounded-xl overflow-hidden shadow-lg w-full h-full",children:[e.jsx("img",{src:We,alt:"主摄像头",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm font-medium",children:[e.jsx(ye,{size:14}),e.jsx("span",{children:"主摄像头"})]}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm",children:"00:42"})]})}),e.jsxs("div",{className:`pip-container bg-black rounded-lg overflow-hidden shadow-xl border-2 border-white/20 hover:border-white/40 ${p==="arm"?"cursor-grabbing":"cursor-grab"} ${d.arm.x===0&&d.arm.y===0?"absolute bottom-4 right-4":"fixed"}`,style:{width:c.arm.width>0?`${c.arm.width}px`:l==="arm"?"33.33%":"16.67%",height:c.arm.height>0?`${c.arm.height}px`:void 0,aspectRatio:c.arm.height>0?void 0:"4/3",...d.arm.x!==0||d.arm.y!==0?{left:`${d.arm.x}px`,top:`${d.arm.y}px`,zIndex:1e3}:{},transition:p==="arm"||o==="arm"?"none":"all 300ms"},onMouseDown:t=>be(t,"arm"),onClick:()=>{if(K||h){a(!1),q(!1);return}I(t=>({...t,arm:{x:0,y:0}})),_(t=>({...t,arm:{width:0,height:0}})),G(l==="arm"?null:"arm")},children:[e.jsx("img",{src:H,alt:"机械臂视角",className:"w-full h-full object-cover pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 pointer-events-none",children:e.jsxs("div",{className:"text-white text-xs font-medium flex items-center gap-1",children:[e.jsx(ve,{size:12}),"机械臂视角"]})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded hover:bg-black/70 transition-colors",onClick:t=>ge("arm",t),title:"重置位置",children:e.jsx(je,{size:12})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded pointer-events-none",children:e.jsx(Ne,{size:12})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize",style:{background:"linear-gradient(135deg, transparent 0%, transparent 50%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0.5) 100%)"},onMouseDown:t=>i(t,"arm")})]})]})}),e.jsx(Ke,{isPlaying:ee,setIsPlaying:R,currentTime:k,duration:L,setCurrentTime:T,formatTime:P,dataValidity:Y,setDataValidity:D,dataCompleteness:X,setDataCompleteness:g,selectedErrorTags:F,setSelectedErrorTags:f,reviewComment:W,setReviewComment:V,isFirstClip:te,isLastClip:se,handlePreviousClip:ae,handleNextClip:B,handleSubmitReview:v})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:()=>he(!A),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{size:16,className:"text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"姿态数据详情"}),e.jsx("span",{className:"text-xs text-gray-500",children:"（机械臂姿态、GELLOW操作器姿态）"})]}),e.jsx(pe,{size:18,className:`text-gray-400 transition-transform ${A?"rotate-90":""}`})]}),A&&e.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"机械臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"X轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-12.3°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Y轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"87.6°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Z轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-45.1°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Roll"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"120.5°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Pitch"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.2°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Yaw"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"30.0°"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"机械臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节1"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"45.2°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-30.5°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节3"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"60.8°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节4"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"15.2°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节5"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.7°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节6"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"90.0°"})]})]})]})]})})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg mt-4",children:[e.jsxs("button",{onClick:()=>M(!m),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{size:16,className:"text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"动作对比分析"}),e.jsx("span",{className:"text-xs text-gray-500",children:"（Action vs Observation）"})]}),e.jsx(pe,{size:18,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),m&&e.jsxs("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Roll"}),e.jsx(ne,{width:"100%",height:240,children:e.jsxs(le,{data:j,onMouseMove:t=>{t&&t.activeLabel!==void 0&&$(t.activeLabel)},onMouseLeave:()=>{$(null)},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ce,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(de,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[-1,0]}),e.jsx(xe,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(me,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),b.action&&e.jsx(E,{type:"monotone",dataKey:"action_roll",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),b.obs&&e.jsx(E,{type:"monotone",dataKey:"obs_roll",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b.action,onChange:t=>u({...b,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Se=j[n])==null?void 0:Se.action_roll.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b.obs,onChange:t=>u({...b,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Me=j[n])==null?void 0:Me.obs_roll.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Angle"}),e.jsx(ne,{width:"100%",height:240,children:e.jsxs(le,{data:j,onMouseMove:t=>{t&&t.activeLabel!==void 0&&$(t.activeLabel)},onMouseLeave:()=>{$(null)},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ce,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(de,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[.5,2]}),e.jsx(xe,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(me,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),S.action&&e.jsx(E,{type:"monotone",dataKey:"action_angle",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),S.obs&&e.jsx(E,{type:"monotone",dataKey:"obs_angle",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.action,onChange:t=>ue({...S,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(ze=j[n])==null?void 0:ze.action_angle.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.obs,onChange:t=>ue({...S,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Le=j[n])==null?void 0:Le.obs_angle.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Gripper"}),e.jsx(ne,{width:"100%",height:240,children:e.jsxs(le,{data:j,onMouseMove:t=>{t&&t.activeLabel!==void 0&&$(t.activeLabel)},onMouseLeave:()=>{$(null)},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ce,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(de,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[.3,1.3]}),e.jsx(xe,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(me,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),Z.action&&e.jsx(E,{type:"monotone",dataKey:"action_gripper",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),Z.obs&&e.jsx(E,{type:"monotone",dataKey:"obs_gripper",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Z.action,onChange:t=>fe({...Z,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Pe=j[n])==null?void 0:Pe.action_gripper.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Z.obs,onChange:t=>fe({...Z,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(De=j[n])==null?void 0:De.obs_gripper.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Pitch"}),e.jsx(ne,{width:"100%",height:240,children:e.jsxs(le,{data:j,onMouseMove:t=>{t&&t.activeLabel!==void 0&&$(t.activeLabel)},onMouseLeave:()=>{$(null)},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ce,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(de,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[-.2,.8]}),e.jsx(xe,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(me,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),J.action&&e.jsx(E,{type:"monotone",dataKey:"action_pitch",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),J.obs&&e.jsx(E,{type:"monotone",dataKey:"obs_pitch",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:J.action,onChange:t=>we({...J,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Ae=j[n])==null?void 0:Ae.action_pitch.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:J.obs,onChange:t=>we({...J,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Re=j[n])==null?void 0:Re.obs_pitch.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Yaw"}),e.jsx(ne,{width:"100%",height:240,children:e.jsxs(le,{data:j,onMouseMove:t=>{t&&t.activeLabel!==void 0&&$(t.activeLabel)},onMouseLeave:()=>{$(null)},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ce,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(de,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[-.8,.4]}),e.jsx(xe,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(me,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),re.action&&e.jsx(E,{type:"monotone",dataKey:"action_yaw",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),re.obs&&e.jsx(E,{type:"monotone",dataKey:"obs_yaw",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:re.action,onChange:t=>ke({...re,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(_e=j[n])==null?void 0:_e.action_yaw.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:re.obs,onChange:t=>ke({...re,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?($e=j[n])==null?void 0:$e.obs_yaw.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Velocity"}),e.jsx(ne,{width:"100%",height:240,children:e.jsxs(le,{data:j,onMouseMove:t=>{t&&t.activeLabel!==void 0&&$(t.activeLabel)},onMouseLeave:()=>{$(null)},children:[e.jsx(oe,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ce,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(de,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[0,1.2]}),e.jsx(xe,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(me,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),ie.action&&e.jsx(E,{type:"monotone",dataKey:"action_velocity",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),ie.obs&&e.jsx(E,{type:"monotone",dataKey:"obs_velocity",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ie.action,onChange:t=>Ce({...ie,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Ee=j[n])==null?void 0:Ee.action_velocity.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ie.obs,onChange:t=>Ce({...ie,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Ye=j[n])==null?void 0:Ye.obs_velocity.toFixed(3):"--"})]})]})]})]}),e.jsx("div",{className:"mt-4 flex items-center justify-center gap-6"})]})]})]})}function at(U){const{isPlaying:ee,setIsPlaying:R,currentTime:k,duration:L,setCurrentTime:T,formatTime:P,dataValidity:Y,setDataValidity:D,dataCompleteness:X,setDataCompleteness:g,selectedErrorTags:F,setSelectedErrorTags:f,reviewComment:W,setReviewComment:V,isPoseDataExpanded:A,setIsPoseDataExpanded:he,isFirstClip:te,isLastClip:se,handlePreviousClip:ae,handleNextClip:B,handleSubmitReview:v}=U,[m,M]=s.useState(null),[l,G]=s.useState({left:{x:0,y:0},right:{x:0,y:0}}),[d,I]=s.useState({left:{width:0,height:0},right:{width:0,height:0}}),[c,_]=s.useState(null),[p,O]=s.useState({x:0,y:0}),[N,r]=s.useState(null),[o,z]=s.useState({x:0,y:0,width:0,height:0}),[C,w]=s.useState(!1),[K,a]=s.useState(!1),h=i=>{if(C||K){w(!1),a(!1);return}G(b=>({...b,[i]:{x:0,y:0}})),I(b=>({...b,[i]:{width:0,height:0}})),M(m===null?i:m===i?null:m==="both"?i==="left"?"right":"left":"both")},q=(i,b)=>{b.stopPropagation(),G(u=>({...u,[i]:{x:0,y:0}})),I(u=>({...u,[i]:{width:0,height:0}}))},ge=(i,b)=>{if(i.target.closest("button"))return;i.preventDefault(),i.stopPropagation(),w(!1),_(b);const u=i.currentTarget.getBoundingClientRect();O({x:i.clientX-u.left,y:i.clientY-u.top}),I(S=>({...S,[b]:{width:u.width,height:u.height}}))},be=(i,b)=>{var S;i.preventDefault(),i.stopPropagation(),a(!1),r(b);const u=(S=i.currentTarget.closest(".pip-container"))==null?void 0:S.getBoundingClientRect();u&&z({x:i.clientX,y:i.clientY,width:u.width,height:u.height})};return s.useEffect(()=>{const i=u=>{if(c&&(w(!0),G(S=>({...S,[c]:{x:u.clientX-p.x,y:u.clientY-p.y}}))),N){a(!0);const S=u.clientX-o.x,ue=u.clientY-o.y,Z=Math.max(150,o.width+S),fe=Math.max(100,o.height+ue);I(J=>({...J,[N]:{width:Z,height:fe}}))}},b=()=>{_(null),r(null)};if(c||N)return document.addEventListener("mousemove",i),document.addEventListener("mouseup",b),()=>{document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",b)}},[c,N,p,o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-5 mb-5",style:{gridTemplateColumns:"1fr 460px"},children:[e.jsx("div",{className:"relative",style:{height:"calc(80vh - 100px)"},children:e.jsxs("div",{className:"relative bg-black rounded-xl overflow-hidden shadow-lg w-full h-full",children:[e.jsx("img",{src:We,alt:"主摄像头",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm font-medium",children:[e.jsx(ye,{size:14}),e.jsx("span",{children:"主摄像头"})]}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm",children:"00:35"})]})}),e.jsxs("div",{className:`pip-container bg-black rounded-lg overflow-hidden shadow-xl border-2 border-white/20 hover:border-white/40 ${c==="left"?"cursor-grabbing":"cursor-grab"} ${l.left.x===0&&l.left.y===0?"absolute bottom-4 right-4":"fixed"}`,style:{width:d.left.width>0?`${d.left.width}px`:m==="left"||m==="both"?"33.33%":"16.67%",height:d.left.height>0?`${d.left.height}px`:void 0,aspectRatio:d.left.height>0?void 0:"4/3",...l.left.x!==0||l.left.y!==0?{left:`${l.left.x}px`,top:`${l.left.y}px`,zIndex:1e3}:{...m===null&&l.right.x===0&&l.right.y===0&&{transform:"translateY(calc(-100% - 0.5rem))"},...m==="right"&&l.right.x===0&&l.right.y===0&&{transform:"translateY(calc(-200% - 1rem))"},...m==="both"&&l.right.x===0&&l.right.y===0&&{transform:"translateY(calc(-100% - 0.5rem))"}},transition:c==="left"||N==="left"?"none":"all 300ms"},onMouseDown:i=>ge(i,"left"),onClick:()=>h("left"),children:[e.jsx("img",{src:H,alt:"左臂视角",className:"w-full h-full object-cover pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 pointer-events-none",children:e.jsxs("div",{className:"text-white text-xs font-medium flex items-center gap-1",children:[e.jsx(ve,{size:12}),"左臂视角"]})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded hover:bg-black/70 transition-colors",onClick:i=>q("left",i),title:"重置位置",children:e.jsx(je,{size:12})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded pointer-events-none",children:e.jsx(Ne,{size:12})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize",style:{background:"linear-gradient(135deg, transparent 0%, transparent 50%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0.5) 100%)"},onMouseDown:i=>be(i,"left")})]}),e.jsxs("div",{className:`pip-container bg-black rounded-lg overflow-hidden shadow-xl border-2 border-white/20 hover:border-white/40 ${c==="right"?"cursor-grabbing":"cursor-grab"} ${l.right.x===0&&l.right.y===0?"absolute bottom-4 right-4":"fixed"}`,style:{width:d.right.width>0?`${d.right.width}px`:m==="right"||m==="both"?"33.33%":"16.67%",height:d.right.height>0?`${d.right.height}px`:void 0,aspectRatio:d.right.height>0?void 0:"4/3",...l.right.x!==0||l.right.y!==0?{left:`${l.right.x}px`,top:`${l.right.y}px`,zIndex:1e3}:{...m==="left"&&l.left.x===0&&l.left.y===0&&{transform:"translateY(calc(-200% - 1rem))"}},transition:c==="right"||N==="right"?"none":"all 300ms"},onMouseDown:i=>ge(i,"right"),onClick:()=>h("right"),children:[e.jsx("img",{src:H,alt:"右臂视角",className:"w-full h-full object-cover pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 pointer-events-none",children:e.jsxs("div",{className:"text-white text-xs font-medium flex items-center gap-1",children:[e.jsx(ve,{size:12}),"右臂视角"]})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded hover:bg-black/70 transition-colors",onClick:i=>q("right",i),title:"重置位置",children:e.jsx(je,{size:12})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded pointer-events-none",children:e.jsx(Ne,{size:12})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize",style:{background:"linear-gradient(135deg, transparent 0%, transparent 50%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0.5) 100%)"},onMouseDown:i=>be(i,"right")})]})]})}),e.jsx(Ke,{isPlaying:ee,setIsPlaying:R,currentTime:k,duration:L,setCurrentTime:T,formatTime:P,dataValidity:Y,setDataValidity:D,dataCompleteness:X,setDataCompleteness:g,selectedErrorTags:F,setSelectedErrorTags:f,reviewComment:W,setReviewComment:V,isFirstClip:te,isLastClip:se,handlePreviousClip:ae,handleNextClip:B,handleSubmitReview:v})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:()=>he(!A),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{size:16,className:"text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"姿态数据情"}),e.jsx("span",{className:"text-xs text-gray-500",children:"（左臂姿态、右臂姿态、GELLOW操作器姿态）"})]}),e.jsx(pe,{size:18,className:`text-gray-400 transition-transform ${A?"rotate-90":""}`})]}),A&&e.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"左臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"X轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-12.3"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Y轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"87.6°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Z轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-45.1°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Roll"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"120.5°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Pitch"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.2°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Yaw"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"30.0°"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"右臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"X轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"18.7°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Y轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-52.3°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Z轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"63.9°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Roll"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-95.4°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Pitch"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"12.6°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Yaw"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-28.1°"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"机械臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节1"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"45.2°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-30.5°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节3"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"60.8°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节4"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"15.2°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节5"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.7°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节6"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"90.0°"})]})]})]})]})})]})]})}export{ot as default};
