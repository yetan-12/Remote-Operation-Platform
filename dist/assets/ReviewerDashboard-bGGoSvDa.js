import{c as we,r as a,a as He,b as Ze,j as e,E as qe,C as Je,B as Xe}from"./index-C4ijDJHY.js";import{C as Qe,h as G,r as Oe}from"./placeholders-DmpdoT2B.js";import{P as ye,C as Te}from"./play-chIzS5U0.js";import{C as pe,R as oe,L as ce,a as de,X as xe,Y as me,T as he,b as ge,c as X}from"./LineChart-BPv3GEBS.js";import{a as ve,H as je,M as Ne,C as et,R as tt}from"./rotate-ccw-DCr_HQT8.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],at=we("grip-vertical",st);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Ie=we("paperclip",rt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],nt=we("pause",it);function ht(){var te,se,r;const[U,ee]=a.useState("SE-20251217-003"),[A,N]=a.useState(!1),[L,O]=a.useState(""),[S,R]=a.useState(null),[M,_]=a.useState(null),[b,$]=a.useState([]),[x,E]=a.useState(null),[K,D]=a.useState(!0),[be,ae]=a.useState("2025-12-17"),[re,ie]=a.useState("2025-12-17"),[B,w]=a.useState(!1),[g,z]=a.useState(0),[o,V]=a.useState(150);a.useRef(null);const{currentUser:m}=He(),{getClipsForUser:Y,submitReview:u}=Ze(),d=(m?Y(m.username):[]).map(s=>({id:s.id,duration:s.duration,description:s.description})),H=d.map(s=>s.id).join(",");a.useEffect(()=>{d.length===0?E(null):(!x||!d.some(s=>s.id===x))&&E(d[0].id)},[H,d.length,x]),a.useEffect(()=>{!x||!K||setTimeout(()=>{const s=document.querySelector(`[data-clip-id="${x}"]`);s&&s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)},[x,K]),a.useEffect(()=>{let s;return A&&(s=setInterval(()=>{z(l=>l>=o?(N(!1),0):l+1)},1e3)),()=>{s&&clearInterval(s)}},[A,o]);const k=s=>{const l=Math.floor(s/60),y=s%60;return`${l}:${y.toString().padStart(2,"0")}`},i=[G,G,G,G,G,G],c=d.findIndex(s=>s.id===x),P=c===0,j=c===d.length-1,f=()=>{if(c>0){const s=d[c-1].id;E(s),setTimeout(()=>{const l=document.querySelector(`[data-clip-id="${s}"]`);l&&l.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},0)}},I=()=>{var l;if(!S||!M){alert("请完成数据有效性和数据完成度的标注");return}if(!x||!m)return;const s=((l=d[c+1])==null?void 0:l.id)??null;u(x,{dataValidity:S,dataCompleteness:M,errorTags:b,reviewComment:L},m.username),R(null),_(null),$([]),O(""),N(!1),z(0),E(s)},C=()=>{if(!S||!M){alert("请完成数据有效性和数据完成度的标注");return}!x||!m||(u(x,{dataValidity:S,dataCompleteness:M,errorTags:b,reviewComment:L},m.username),E(null),R(null),_(null),$([]),O(""),N(!1),z(0))},W=x===((te=d[0])==null?void 0:te.id)||x==="C-TEST-01",Z=x===((se=d[1])==null?void 0:se.id)||x==="C-TEST-02";return e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:`bg-white border-r border-gray-200 flex flex-col relative transition-all duration-300 ${K?"w-[12.5%]":"w-12"}`,children:K?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-3 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:"Clips列表"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",title:"折叠",children:e.jsx(Qe,{size:18})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-1 space-y-1 custom-scrollbar",children:d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4 text-center",children:[e.jsx(Ie,{className:"w-10 h-10 text-gray-300 mb-2"}),e.jsx("p",{className:"text-xs text-gray-500",children:"暂无分配的 Clip"})]}):d.map((s,l)=>e.jsxs("div",{"data-clip-id":s.id,onClick:()=>E(s.id),className:`cursor-pointer transition-all rounded p-1 shadow-sm ${x===s.id?"ring-2 ring-blue-500 bg-blue-50":"hover:ring-1 hover:ring-gray-300 bg-white"}`,children:[e.jsxs("div",{className:"relative bg-black w-full aspect-video rounded overflow-hidden",children:[e.jsx("img",{src:i[l%i.length],alt:s.id,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-7 h-7 rounded-full bg-white/95 flex items-center justify-center shadow-lg",children:e.jsx(ye,{size:12,className:"text-gray-800 ml-0.5"})})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-black/80 text-white text-[9px] px-1.5 py-0.5 rounded font-medium",children:s.duration}),x===s.id&&e.jsx("div",{className:"absolute top-1 left-1 w-2 h-2 bg-blue-500 rounded-full ring-2 ring-white shadow-sm"})]}),e.jsx("div",{className:`px-1.5 py-1.5 transition-all ${x===s.id?"bg-blue-500 text-white":"bg-white text-gray-800"}`,children:e.jsx("div",{className:"text-[10px] font-bold text-center tracking-wide",children:s.id})})]},s.id))})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-full flex flex-col items-center py-4",children:[e.jsx("button",{onClick:()=>D(!0),className:"text-gray-400 hover:text-gray-600 transition-colors mb-4",title:"展开",children:e.jsx(pe,{size:18})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"[writing-mode:vertical-lr] text-sm font-semibold text-gray-600 tracking-wider",children:"Clips"})})]})})}),e.jsxs("div",{className:"flex-1 bg-gray-50 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"数据标注"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["已选择: ",x]}),e.jsxs("button",{className:"text-sm text-blue-600 hover:underline",children:["共 ",d.length," 条"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 custom-scrollbar",children:d.length===0?e.jsx("div",{className:"bg-white rounded-lg p-6 mb-4 h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ie,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"暂无分配给你的 Clip"}),e.jsx("p",{className:"text-xs text-gray-500",children:"请联系管理员在「数据管理」页面为你分配标注任务后，此处将显示可标注的 Clip 列表"})]})}):x?e.jsxs("div",{className:"bg-white rounded-lg p-6 mb-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"当前clips任务提示 (Prompt)"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["当前Prompt: ",((r=d.find(s=>s.id===x))==null?void 0:r.description)||"暂无描述"]})]}),W?e.jsx(We,{isPlaying:A,setIsPlaying:N,currentTime:g,duration:o,setCurrentTime:z,formatTime:k,dataValidity:S,setDataValidity:R,dataCompleteness:M,setDataCompleteness:_,selectedErrorTags:b,setSelectedErrorTags:$,reviewComment:L,setReviewComment:O,isPoseDataExpanded:B,setIsPoseDataExpanded:w,isFirstClip:P,isLastClip:j,handlePreviousClip:f,handleSubmitAndNext:I,handleSubmitReview:C}):Z?e.jsx(lt,{isPlaying:A,setIsPlaying:N,currentTime:g,duration:o,setCurrentTime:z,formatTime:k,dataValidity:S,setDataValidity:R,dataCompleteness:M,setDataCompleteness:_,selectedErrorTags:b,setSelectedErrorTags:$,reviewComment:L,setReviewComment:O,isPoseDataExpanded:B,setIsPoseDataExpanded:w,isFirstClip:P,isLastClip:j,handlePreviousClip:f,handleSubmitAndNext:I,handleSubmitReview:C}):e.jsx(We,{isPlaying:A,setIsPlaying:N,currentTime:g,duration:o,setCurrentTime:z,formatTime:k,dataValidity:S,setDataValidity:R,dataCompleteness:M,setDataCompleteness:_,selectedErrorTags:b,setSelectedErrorTags:$,reviewComment:L,setReviewComment:O,isPoseDataExpanded:B,setIsPoseDataExpanded:w,isFirstClip:P,isLastClip:j,handlePreviousClip:f,handleSubmitAndNext:I,handleSubmitReview:C})]}):e.jsx("div",{className:"bg-white rounded-lg p-6 mb-4 h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(qe,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"请选择 Clip 以开始数据标注"}),e.jsx("p",{className:"text-xs text-gray-500",children:"从左侧列表中选择一个 Clip 来查看详情并进行标注"})]})})})]})]})}function Ke({isPlaying:U,setIsPlaying:ee,currentTime:A,duration:N,setCurrentTime:L,formatTime:O,dataValidity:S,setDataValidity:R,dataCompleteness:M,setDataCompleteness:_,selectedErrorTags:b,setSelectedErrorTags:$,reviewComment:x,setReviewComment:E,isFirstClip:K,isLastClip:D,handlePreviousClip:be,handleSubmitAndNext:ae,handleSubmitReview:re}){const[ie,B]=a.useState(1),[w,g]=a.useState({x:0,y:0}),[z,o]=a.useState(!1),V=a.useRef(null),m=30,Y=Math.floor(A*m),u=Math.floor(N*m),T=[.25,.5,1,2],d=()=>{L(0),ee(!0)},H=()=>{g({x:0,y:0})},k=i=>{var C;o(!0);const c=(C=V.current)==null?void 0:C.getBoundingClientRect();if(!c)return;const P=i.clientX-c.left,j=i.clientY-c.top,f=W=>{g({x:W.clientX-P,y:W.clientY-j})},I=()=>{o(!1),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",I)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",I)};return e.jsxs("div",{className:"flex flex-col",style:{height:"calc(80vh - 160px)"},children:[e.jsxs("div",{ref:V,className:"fixed z-50 bg-white rounded-xl border border-gray-300 shadow-2xl p-4 flex items-center min-w-[700px] max-w-[900px]",style:{left:w.x===0&&w.y===0?"50%":`${w.x}px`,top:w.y===0?"auto":`${w.y}px`,bottom:w.y===0?"24px":"auto",transform:w.x===0&&w.y===0?"translateX(-50%)":"none",cursor:z?"grabbing":"default"},children:[e.jsx("div",{onMouseDown:k,className:"flex items-center justify-center px-2 cursor-grab active:cursor-grabbing hover:bg-gray-100 rounded-lg transition-colors mr-2",title:"拖动控制栏",children:e.jsx(at,{size:20,className:"text-gray-400"})}),e.jsx("button",{onClick:H,className:"p-2 hover:bg-gray-100 text-gray-600 hover:text-blue-600 rounded-lg transition-all mr-2",title:"重置位置",children:e.jsx(je,{size:18})}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>ee(!U),className:"p-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center flex-shrink-0 shadow-md hover:shadow-lg transition-all",title:U?"暂停":"播放",children:U?e.jsx(nt,{size:18}):e.jsx(ye,{size:18})}),e.jsx("button",{onClick:d,className:"p-2.5 bg-gray-600 hover:bg-gray-700 text-white rounded-lg flex items-center justify-center flex-shrink-0 shadow-md hover:shadow-lg transition-all",title:"重播",children:e.jsx(tt,{size:18})}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 bg-gray-200 rounded-full h-1 cursor-pointer relative",style:{overflow:"visible"},onClick:i=>{if(i.target.closest("button"))return;const c=i.currentTarget.getBoundingClientRect(),j=(i.clientX-c.left)/c.width,f=Math.floor(j*N);L(f)},onMouseDown:i=>{if(i.target.closest("button"))return;const c=j=>{const f=i.currentTarget.getBoundingClientRect(),C=Math.max(0,Math.min(j.clientX-f.left,f.width))/f.width,W=Math.floor(C*N);L(W)},P=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",P)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",P)},children:[e.jsx("div",{className:"bg-blue-600 h-full transition-all duration-300 rounded-full",style:{width:`${A/N*100}%`}}),e.jsx("button",{onClick:i=>{i.stopPropagation(),i.preventDefault();const c=Math.floor(N*.5);L(c),console.log("跳转到关键帧:",c)},className:"absolute -top-4 left-1/2 -translate-x-1/2 hover:scale-110 transition-transform cursor-pointer z-10",style:{pointerEvents:"auto"},title:"关键帧",children:e.jsxs("div",{className:"flex flex-col items-center pointer-events-none",children:[e.jsx("div",{className:"w-0 h-0 border-l-[8px] border-r-[8px] border-t-[12px] border-l-transparent border-r-transparent border-t-orange-500 drop-shadow-lg"}),e.jsx("div",{className:"w-2 h-3 bg-gradient-to-b from-orange-500 to-orange-600 -mt-0.5 drop-shadow-lg rounded-b-sm"})]})})]}),e.jsxs("span",{className:"text-xs text-gray-600 font-medium whitespace-nowrap",children:[Y," / ",u," 帧"]}),e.jsx("select",{value:ie,onChange:i=>B(Number(i.target.value)),className:"text-xs border border-gray-300 rounded-md px-2.5 py-1 bg-white hover:border-blue-400 focus:outline-none focus:border-blue-500 cursor-pointer font-medium text-gray-700",children:T.map(i=>e.jsxs("option",{value:i,children:[i,"x"]},i))})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-3",children:"标注操作"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-red-500 text-xs",children:"*"}),e.jsx("label",{className:"text-xs text-gray-700",children:"数据有效性:"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R("valid"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${S==="valid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"有效"}),e.jsx("button",{onClick:()=>R("invalid"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${S==="invalid"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"无效"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-red-500 text-xs",children:"*"}),e.jsx("label",{className:"text-xs text-gray-700",children:"动作完成度:"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_("complete"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${M==="complete"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"完成"}),e.jsx("button",{onClick:()=>_("incomplete"),className:`flex-1 py-2 px-3 rounded-md text-xs font-medium transition-all ${M==="incomplete"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"未完成"})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-2",children:"错误标签 (选填)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>{const i=document.getElementById("error-tags-dropdown");i&&i.classList.toggle("hidden")},className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-xs text-left hover:bg-gray-50 transition-colors flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-700",children:b&&b.length>0?`已选择 ${b.length} 个标签`:"选择错误标签"}),e.jsx(Je,{className:"w-4 h-4 text-gray-500"})]}),e.jsx("div",{id:"error-tags-dropdown",className:"hidden absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg",children:["动作不完整","画面模糊","机械臂异常"].map(i=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-50 cursor-pointer text-xs",children:[e.jsx("input",{type:"checkbox",checked:b==null?void 0:b.includes(i),onChange:()=>{b!=null&&b.includes(i)?$(b.filter(c=>c!==i)):$([...b||[],i])},className:"w-4 h-4 text-blue-500 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:i})]},i))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col mb-3 min-h-0",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-900 mb-2",children:"审核意见 (选填)"}),e.jsx("textarea",{placeholder:"请输入详细注意事项或说明信息",value:x,onChange:i=>E(i.target.value),className:"w-full flex-1 px-2.5 py-2 border border-gray-200 rounded-lg text-xs resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Xe,{className:`w-full h-8 text-xs ${D?"bg-gray-100 text-gray-400 border border-gray-200 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,onClick:()=>{if(!S||!M){alert("请完成数据有效性和动作完成度的标注");return}ae()},disabled:D,children:"提交并下一条"}),e.jsx(Xe,{className:"w-full h-8 text-xs bg-white hover:bg-gray-50 text-gray-700 border border-gray-300",onClick:re,children:"提交并返回"})]})]})}function We(U){var Me,ze,Le,Pe,De,Ae,Re,_e,$e,Ee,Ye,Fe;const{isPlaying:ee,setIsPlaying:A,currentTime:N,duration:L,setCurrentTime:O,formatTime:S,dataValidity:R,setDataValidity:M,dataCompleteness:_,setDataCompleteness:b,selectedErrorTags:$,setSelectedErrorTags:x,reviewComment:E,setReviewComment:K,isPoseDataExpanded:D,setIsPoseDataExpanded:be,isFirstClip:ae,isLastClip:re,handlePreviousClip:ie,handleSubmitAndNext:B,handleSubmitReview:w}=U;a.useRef(null);const[g,z]=a.useState(!1),[o,V]=a.useState(null),[m,Y]=a.useState({arm:{x:0,y:0}}),[u,T]=a.useState({arm:{width:0,height:0}}),[d,H]=a.useState(null),[k,i]=a.useState({x:0,y:0}),[c,P]=a.useState(null),[j,f]=a.useState({x:0,y:0,width:0,height:0}),[I,C]=a.useState(!1),[W,Z]=a.useState(!1),te=(t,h)=>{h.stopPropagation(),Y(v=>({...v,[t]:{x:0,y:0}})),T(v=>({...v,[t]:{width:0,height:0}}))},se=(t,h)=>{if(t.target.closest("button"))return;t.preventDefault(),t.stopPropagation(),C(!1),H(h);const v=t.currentTarget.getBoundingClientRect();i({x:t.clientX-v.left,y:t.clientY-v.top}),T(Q=>({...Q,[h]:{width:v.width,height:v.height}}))},r=(t,h)=>{var Q;t.preventDefault(),t.stopPropagation(),Z(!1),P(h);const v=(Q=t.currentTarget.closest(".pip-container"))==null?void 0:Q.getBoundingClientRect();v&&f({x:t.clientX,y:t.clientY,width:v.width,height:v.height})};a.useEffect(()=>{const t=v=>{if(d&&(C(!0),Y(Q=>({...Q,[d]:{x:v.clientX-k.x,y:v.clientY-k.y}}))),c){Z(!0);const Q=v.clientX-j.x,Be=v.clientY-j.y,Ve=Math.max(150,j.width+Q),Ge=Math.max(100,j.height+Be);T(Ue=>({...Ue,[c]:{width:Ve,height:Ge}}))}},h=()=>{H(null),P(null)};if(d||c)return document.addEventListener("mousemove",t),document.addEventListener("mouseup",h),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",h)}},[d,c,k,j]);const[s,l]=a.useState({action:!0,obs:!0}),[y,ue]=a.useState({action:!0,obs:!0}),[q,fe]=a.useState({action:!0,obs:!0}),[J,ke]=a.useState({action:!0,obs:!0}),[ne,Ce]=a.useState({action:!0,obs:!0}),[le,Se]=a.useState({action:!0,obs:!0}),[n,F]=a.useState(null),p=a.useMemo(()=>Array.from({length:50},(t,h)=>({frame:h,action_roll:-.5+Math.sin(h/8)*.3+(Math.random()-.5)*.1,obs_roll:-.5+Math.sin(h/8)*.3+(Math.random()-.5)*.15,action_angle:1.2+Math.cos(h/10)*.4+(Math.random()-.5)*.1,obs_angle:1.2+Math.cos(h/10)*.4+(Math.random()-.5)*.15,action_gripper:.8+Math.sin(h/6)*.2+(Math.random()-.5)*.08,obs_gripper:.8+Math.sin(h/6)*.2+(Math.random()-.5)*.12,action_pitch:.3+Math.cos(h/12)*.25+(Math.random()-.5)*.08,obs_pitch:.3+Math.cos(h/12)*.25+(Math.random()-.5)*.12,action_yaw:-.2+Math.sin(h/9)*.3+(Math.random()-.5)*.1,obs_yaw:-.2+Math.sin(h/9)*.3+(Math.random()-.5)*.15,action_velocity:.5+Math.cos(h/7)*.3+(Math.random()-.5)*.1,obs_velocity:.5+Math.cos(h/7)*.3+(Math.random()-.5)*.15})),[]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-5 mb-5",style:{gridTemplateColumns:"1fr 460px"},children:[e.jsx("div",{className:"relative",style:{height:"calc(80vh - 100px)"},children:e.jsxs("div",{className:"relative bg-black rounded-xl overflow-hidden shadow-lg w-full h-full",children:[e.jsx("img",{src:Oe,alt:"主摄像头",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm font-medium",children:[e.jsx(ye,{size:14}),e.jsx("span",{children:"主摄像头"})]}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm",children:"00:42"})]})}),e.jsxs("div",{className:`pip-container bg-black rounded-lg overflow-hidden shadow-xl border-2 border-white/20 hover:border-white/40 ${d==="arm"?"cursor-grabbing":"cursor-grab"} ${m.arm.x===0&&m.arm.y===0?"absolute bottom-4 right-4":"fixed"}`,style:{width:u.arm.width>0?`${u.arm.width}px`:o==="arm"?"33.33%":"16.67%",height:u.arm.height>0?`${u.arm.height}px`:void 0,aspectRatio:u.arm.height>0?void 0:"4/3",...m.arm.x!==0||m.arm.y!==0?{left:`${m.arm.x}px`,top:`${m.arm.y}px`,zIndex:1e3}:{},transition:d==="arm"||c==="arm"?"none":"all 300ms"},onMouseDown:t=>se(t,"arm"),onClick:()=>{if(I||W){C(!1),Z(!1);return}Y(t=>({...t,arm:{x:0,y:0}})),T(t=>({...t,arm:{width:0,height:0}})),V(o==="arm"?null:"arm")},children:[e.jsx("img",{src:G,alt:"机械臂视角",className:"w-full h-full object-cover pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 pointer-events-none",children:e.jsxs("div",{className:"text-white text-xs font-medium flex items-center gap-1",children:[e.jsx(ve,{size:12}),"机械臂视角"]})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded hover:bg-black/70 transition-colors",onClick:t=>te("arm",t),title:"重置位置",children:e.jsx(je,{size:12})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded pointer-events-none",children:e.jsx(Ne,{size:12})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize",style:{background:"linear-gradient(135deg, transparent 0%, transparent 50%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0.5) 100%)"},onMouseDown:t=>r(t,"arm")})]})]})}),e.jsx(Ke,{isPlaying:ee,setIsPlaying:A,currentTime:N,duration:L,setCurrentTime:O,formatTime:S,dataValidity:R,setDataValidity:M,dataCompleteness:_,setDataCompleteness:b,selectedErrorTags:$,setSelectedErrorTags:x,reviewComment:E,setReviewComment:K,isFirstClip:ae,isLastClip:re,handlePreviousClip:ie,handleSubmitAndNext:B,handleSubmitReview:w})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:()=>be(!D),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{size:16,className:"text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"姿态数据详情"}),e.jsx("span",{className:"text-xs text-gray-500",children:"（机械臂姿态、GELLOW操作器姿态）"})]}),e.jsx(pe,{size:18,className:`text-gray-400 transition-transform ${D?"rotate-90":""}`})]}),D&&e.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"机械臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"X轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-12.3°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Y轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"87.6°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Z轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-45.1°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Roll"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"120.5°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Pitch"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.2°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Yaw"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"30.0°"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"机械臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节1"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"45.2°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-30.5°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节3"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"60.8°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节4"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"15.2°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节5"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.7°"})]}),e.jsxs("div",{className:"border border-gray-100 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节6"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"90.0°"})]})]})]})]})})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg mt-4",children:[e.jsxs("button",{onClick:()=>z(!g),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{size:16,className:"text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"动作对比分析"}),e.jsx("span",{className:"text-xs text-gray-500",children:"（Action vs Observation）"})]}),e.jsx(pe,{size:18,className:`text-gray-400 transition-transform ${g?"rotate-90":""}`})]}),g&&e.jsxs("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Roll"}),e.jsx(oe,{width:"100%",height:240,children:e.jsxs(ce,{data:p,onMouseMove:t=>{t&&t.activeLabel!==void 0&&F(t.activeLabel)},onMouseLeave:()=>{F(null)},children:[e.jsx(de,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(xe,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(me,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[-1,0]}),e.jsx(he,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(ge,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),s.action&&e.jsx(X,{type:"monotone",dataKey:"action_roll",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),s.obs&&e.jsx(X,{type:"monotone",dataKey:"obs_roll",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.action,onChange:t=>l({...s,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Me=p[n])==null?void 0:Me.action_roll.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.obs,onChange:t=>l({...s,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(ze=p[n])==null?void 0:ze.obs_roll.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Angle"}),e.jsx(oe,{width:"100%",height:240,children:e.jsxs(ce,{data:p,onMouseMove:t=>{t&&t.activeLabel!==void 0&&F(t.activeLabel)},onMouseLeave:()=>{F(null)},children:[e.jsx(de,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(xe,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(me,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[.5,2]}),e.jsx(he,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(ge,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),y.action&&e.jsx(X,{type:"monotone",dataKey:"action_angle",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),y.obs&&e.jsx(X,{type:"monotone",dataKey:"obs_angle",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.action,onChange:t=>ue({...y,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Le=p[n])==null?void 0:Le.action_angle.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.obs,onChange:t=>ue({...y,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Pe=p[n])==null?void 0:Pe.obs_angle.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Gripper"}),e.jsx(oe,{width:"100%",height:240,children:e.jsxs(ce,{data:p,onMouseMove:t=>{t&&t.activeLabel!==void 0&&F(t.activeLabel)},onMouseLeave:()=>{F(null)},children:[e.jsx(de,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(xe,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(me,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[.3,1.3]}),e.jsx(he,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(ge,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),q.action&&e.jsx(X,{type:"monotone",dataKey:"action_gripper",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),q.obs&&e.jsx(X,{type:"monotone",dataKey:"obs_gripper",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:q.action,onChange:t=>fe({...q,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(De=p[n])==null?void 0:De.action_gripper.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:q.obs,onChange:t=>fe({...q,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Ae=p[n])==null?void 0:Ae.obs_gripper.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Pitch"}),e.jsx(oe,{width:"100%",height:240,children:e.jsxs(ce,{data:p,onMouseMove:t=>{t&&t.activeLabel!==void 0&&F(t.activeLabel)},onMouseLeave:()=>{F(null)},children:[e.jsx(de,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(xe,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(me,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[-.2,.8]}),e.jsx(he,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(ge,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),J.action&&e.jsx(X,{type:"monotone",dataKey:"action_pitch",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),J.obs&&e.jsx(X,{type:"monotone",dataKey:"obs_pitch",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:J.action,onChange:t=>ke({...J,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Re=p[n])==null?void 0:Re.action_pitch.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:J.obs,onChange:t=>ke({...J,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(_e=p[n])==null?void 0:_e.obs_pitch.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Yaw"}),e.jsx(oe,{width:"100%",height:240,children:e.jsxs(ce,{data:p,onMouseMove:t=>{t&&t.activeLabel!==void 0&&F(t.activeLabel)},onMouseLeave:()=>{F(null)},children:[e.jsx(de,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(xe,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(me,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[-.8,.4]}),e.jsx(he,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(ge,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),ne.action&&e.jsx(X,{type:"monotone",dataKey:"action_yaw",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),ne.obs&&e.jsx(X,{type:"monotone",dataKey:"obs_yaw",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ne.action,onChange:t=>Ce({...ne,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?($e=p[n])==null?void 0:$e.action_yaw.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ne.obs,onChange:t=>Ce({...ne,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Ee=p[n])==null?void 0:Ee.obs_yaw.toFixed(3):"--"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 shadow-sm",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Velocity"}),e.jsx(oe,{width:"100%",height:240,children:e.jsxs(ce,{data:p,onMouseMove:t=>{t&&t.activeLabel!==void 0&&F(t.activeLabel)},onMouseLeave:()=>{F(null)},children:[e.jsx(de,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(xe,{dataKey:"frame",tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af"}),e.jsx(me,{tick:{fontSize:11,fill:"#4b5563"},stroke:"#9ca3af",domain:[0,1.2]}),e.jsx(he,{contentStyle:{fontSize:11}}),n!==null&&e.jsx(ge,{x:n,stroke:"#ef4444",strokeWidth:2,strokeDasharray:"3 3"}),le.action&&e.jsx(X,{type:"monotone",dataKey:"action_velocity",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Action",isAnimationActive:!1}),le.obs&&e.jsx(X,{type:"monotone",dataKey:"obs_velocity",stroke:"#10b981",strokeWidth:2,dot:!1,name:"Obs",isAnimationActive:!1})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:le.action,onChange:t=>Se({...le,action:t.target.checked}),className:"w-3.5 h-3.5 text-blue-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Action"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Ye=p[n])==null?void 0:Ye.action_velocity.toFixed(3):"--"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:le.obs,onChange:t=>Se({...le,obs:t.target.checked}),className:"w-3.5 h-3.5 text-green-500 rounded border-gray-300"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 w-20",children:"Observation"}),e.jsx("span",{className:"text-xs font-mono text-gray-600",children:n!==null?(Fe=p[n])==null?void 0:Fe.obs_velocity.toFixed(3):"--"})]})]})]})]}),e.jsx("div",{className:"mt-4 flex items-center justify-center gap-6"})]})]})]})}function lt(U){const{isPlaying:ee,setIsPlaying:A,currentTime:N,duration:L,setCurrentTime:O,formatTime:S,dataValidity:R,setDataValidity:M,dataCompleteness:_,setDataCompleteness:b,selectedErrorTags:$,setSelectedErrorTags:x,reviewComment:E,setReviewComment:K,isPoseDataExpanded:D,setIsPoseDataExpanded:be,isFirstClip:ae,isLastClip:re,handlePreviousClip:ie,handleSubmitAndNext:B,handleSubmitReview:w}=U,[g,z]=a.useState(null),[o,V]=a.useState({left:{x:0,y:0},right:{x:0,y:0}}),[m,Y]=a.useState({left:{width:0,height:0},right:{width:0,height:0}}),[u,T]=a.useState(null),[d,H]=a.useState({x:0,y:0}),[k,i]=a.useState(null),[c,P]=a.useState({x:0,y:0,width:0,height:0}),[j,f]=a.useState(!1),[I,C]=a.useState(!1),W=r=>{if(j||I){f(!1),C(!1);return}V(s=>({...s,[r]:{x:0,y:0}})),Y(s=>({...s,[r]:{width:0,height:0}})),z(g===null?r:g===r?null:g==="both"?r==="left"?"right":"left":"both")},Z=(r,s)=>{s.stopPropagation(),V(l=>({...l,[r]:{x:0,y:0}})),Y(l=>({...l,[r]:{width:0,height:0}}))},te=(r,s)=>{if(r.target.closest("button"))return;r.preventDefault(),r.stopPropagation(),f(!1),T(s);const l=r.currentTarget.getBoundingClientRect();H({x:r.clientX-l.left,y:r.clientY-l.top}),Y(y=>({...y,[s]:{width:l.width,height:l.height}}))},se=(r,s)=>{var y;r.preventDefault(),r.stopPropagation(),C(!1),i(s);const l=(y=r.currentTarget.closest(".pip-container"))==null?void 0:y.getBoundingClientRect();l&&P({x:r.clientX,y:r.clientY,width:l.width,height:l.height})};return a.useEffect(()=>{const r=l=>{if(u&&(f(!0),V(y=>({...y,[u]:{x:l.clientX-d.x,y:l.clientY-d.y}}))),k){C(!0);const y=l.clientX-c.x,ue=l.clientY-c.y,q=Math.max(150,c.width+y),fe=Math.max(100,c.height+ue);Y(J=>({...J,[k]:{width:q,height:fe}}))}},s=()=>{T(null),i(null)};if(u||k)return document.addEventListener("mousemove",r),document.addEventListener("mouseup",s),()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)}},[u,k,d,c]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-5 mb-5",style:{gridTemplateColumns:"1fr 460px"},children:[e.jsx("div",{className:"relative",style:{height:"calc(80vh - 100px)"},children:e.jsxs("div",{className:"relative bg-black rounded-xl overflow-hidden shadow-lg w-full h-full",children:[e.jsx("img",{src:Oe,alt:"主摄像头",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm font-medium",children:[e.jsx(ye,{size:14}),e.jsx("span",{children:"主摄像头"})]}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-sm",children:"00:35"})]})}),e.jsxs("div",{className:`pip-container bg-black rounded-lg overflow-hidden shadow-xl border-2 border-white/20 hover:border-white/40 ${u==="left"?"cursor-grabbing":"cursor-grab"} ${o.left.x===0&&o.left.y===0?"absolute bottom-4 right-4":"fixed"}`,style:{width:m.left.width>0?`${m.left.width}px`:g==="left"||g==="both"?"33.33%":"16.67%",height:m.left.height>0?`${m.left.height}px`:void 0,aspectRatio:m.left.height>0?void 0:"4/3",...o.left.x!==0||o.left.y!==0?{left:`${o.left.x}px`,top:`${o.left.y}px`,zIndex:1e3}:{...g===null&&o.right.x===0&&o.right.y===0&&{transform:"translateY(calc(-100% - 0.5rem))"},...g==="right"&&o.right.x===0&&o.right.y===0&&{transform:"translateY(calc(-200% - 1rem))"},...g==="both"&&o.right.x===0&&o.right.y===0&&{transform:"translateY(calc(-100% - 0.5rem))"}},transition:u==="left"||k==="left"?"none":"all 300ms"},onMouseDown:r=>te(r,"left"),onClick:()=>W("left"),children:[e.jsx("img",{src:G,alt:"左臂视角",className:"w-full h-full object-cover pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 pointer-events-none",children:e.jsxs("div",{className:"text-white text-xs font-medium flex items-center gap-1",children:[e.jsx(ve,{size:12}),"左臂视角"]})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded hover:bg-black/70 transition-colors",onClick:r=>Z("left",r),title:"重置位置",children:e.jsx(je,{size:12})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded pointer-events-none",children:e.jsx(Ne,{size:12})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize",style:{background:"linear-gradient(135deg, transparent 0%, transparent 50%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0.5) 100%)"},onMouseDown:r=>se(r,"left")})]}),e.jsxs("div",{className:`pip-container bg-black rounded-lg overflow-hidden shadow-xl border-2 border-white/20 hover:border-white/40 ${u==="right"?"cursor-grabbing":"cursor-grab"} ${o.right.x===0&&o.right.y===0?"absolute bottom-4 right-4":"fixed"}`,style:{width:m.right.width>0?`${m.right.width}px`:g==="right"||g==="both"?"33.33%":"16.67%",height:m.right.height>0?`${m.right.height}px`:void 0,aspectRatio:m.right.height>0?void 0:"4/3",...o.right.x!==0||o.right.y!==0?{left:`${o.right.x}px`,top:`${o.right.y}px`,zIndex:1e3}:{...g==="left"&&o.left.x===0&&o.left.y===0&&{transform:"translateY(calc(-200% - 1rem))"}},transition:u==="right"||k==="right"?"none":"all 300ms"},onMouseDown:r=>te(r,"right"),onClick:()=>W("right"),children:[e.jsx("img",{src:G,alt:"右臂视角",className:"w-full h-full object-cover pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2 pointer-events-none",children:e.jsxs("div",{className:"text-white text-xs font-medium flex items-center gap-1",children:[e.jsx(ve,{size:12}),"右臂视角"]})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded hover:bg-black/70 transition-colors",onClick:r=>Z("right",r),title:"重置位置",children:e.jsx(je,{size:12})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-md text-white p-1 rounded pointer-events-none",children:e.jsx(Ne,{size:12})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-nwse-resize",style:{background:"linear-gradient(135deg, transparent 0%, transparent 50%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0.5) 100%)"},onMouseDown:r=>se(r,"right")})]})]})}),e.jsx(Ke,{isPlaying:ee,setIsPlaying:A,currentTime:N,duration:L,setCurrentTime:O,formatTime:S,dataValidity:R,setDataValidity:M,dataCompleteness:_,setDataCompleteness:b,selectedErrorTags:$,setSelectedErrorTags:x,reviewComment:E,setReviewComment:K,isFirstClip:ae,isLastClip:re,handlePreviousClip:ie,handleSubmitAndNext:B,handleSubmitReview:w})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:()=>be(!D),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{size:16,className:"text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"姿态数据情"}),e.jsx("span",{className:"text-xs text-gray-500",children:"（左臂姿态、右臂姿态、GELLOW操作器姿态）"})]}),e.jsx(pe,{size:18,className:`text-gray-400 transition-transform ${D?"rotate-90":""}`})]}),D&&e.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"左臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"X轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-12.3"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Y轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"87.6°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Z轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-45.1°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Roll"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"120.5°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Pitch"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.2°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Yaw"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"30.0°"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"右臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"X轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"18.7°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Y轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-52.3°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Z轴"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"63.9°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Roll"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-95.4°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Pitch"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"12.6°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Yaw"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-28.1°"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"机械臂姿态"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节1"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"45.2°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节2"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-30.5°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节3"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"60.8°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节4"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"15.2°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节5"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"-8.7°"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"关节6"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"90.0°"})]})]})]})]})})]})]})}export{ht as default};
